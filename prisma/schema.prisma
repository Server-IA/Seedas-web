// Este es tu archivo de esquema Prisma,
// aprende más al respecto en la documentación: https://pris.ly/d/prisma-schema

// Generador para el cliente Prisma
generator client {
  provider = "prisma-client-js"
}

// Fuente de datos para la base de datos MySQL
datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {  
  id        String   @id @default(uuid())  
  email     String   @unique  
  fullName  String?  
  imageUrl  String?  
  externalId String  @unique  
  clerkId   String?  // Agregamos el campo clerkId  
  posts     Post[]   @relation("UserPublication")  
  publications Publication[] // Add this relation if you want to list publications  
  createdAt DateTime @default(now())  
  updatedAt DateTime @updatedAt  
}  

model Post {  
  id        Int      @id @default(autoincrement())  
  title     String  
  content   String  
  userId    String   // Changed field type to String to match User.id  
  createdAt DateTime @default(now())  
  updatedAt DateTime @updatedAt  

  User      User     @relation("UserPublication", fields: [userId], references: [id]) // Correct the usage of @relation  
}  

model Publication {  
  id             Int      @id @default(autoincrement())  
  userId         String   // Changed field type to String to match User.id  
  pickupLocation String   // Puede ser JSON con latitud/longitud  
  dropoffLocation String  // Puede ser JSON con latitud/longitud  
  zoneId         String   // Zona identificadora (código postal, región)  
  vehicleType    String  
  paymentMethod  String   // "card" o "cash"  
  status         String   // "pending", "active", "completed"  
  createdAt      DateTime @default(now())  
  updatedAt      DateTime @updatedAt  

  User           User     @relation(fields: [userId], references: [id]) // Correct relation syntax  
}  

// Modelo para el Productor
model Productor {
  id        Int      @id @default(autoincrement())
  nombre    String
  email     String   @unique
  telefono  String?
 
  // Otros campos específicos del Productor
  // Relación con los Pedidos
  pedidos   Pedido[]
}

// Modelo para el Transportador
model Transportador {
  id        Int      @id @default(autoincrement())
  nombre    String
  email     String   @unique
  telefono  String?
  
  // Otros campos específicos del Transportador
  // Relación con los Pedidos
  pedidos   Pedido[]
}

// Modelo para los Pedidos
model Pedido {
  id               Int      @id @default(autoincrement())
  fechaCreacion    DateTime @default(now())
  // Otros campos específicos del Pedido
  // Relación con el Productor
  productor        Productor @relation(fields: [productorId], references: [id])
  productorId      Int
  // Relación con el Transportador
  transportador    Transportador @relation(fields: [transportadorId], references: [id])
  transportadorId  Int
}
